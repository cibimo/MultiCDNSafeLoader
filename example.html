<!DOCTYPE html>
<html lang="zh-cn" style="height: 100%" data-bs-theme="auto">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="shortcut icon" href="/static/icon.ico"/>
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <!-- ios平台 safari -->
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="title"/>
        <link rel="apple-touch-icon-precomposed" href="/static/icon.ico"/>
        
        <script>
const res = {
  "cdn_prefixes": [
    // "https://cdn.bytedance.com/cdn/expire-1-M/",
    "https://cdnjs.snrat.com/ajax/libs/",
    "https://cdn.staticfile.net/ajax/libs/",
    "https://cdn.bootcdn.net/ajax/libs/",
    "https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/",
    "https://cdnjs.cloudflare.com/ajax/libs/"
  ],
  "resources": {
    "jquery": {
      "suffix": "jquery/3.6.0/jquery.min.js",
      "sri": "sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==",
      "use_cdn": true
    },
    "layer_css": {
      "suffix": "layer/3.5.1/theme/default/layer.css",
      "sri": "sha512-Pwa1ERbX+AJtgcfrajxNhxRi0J/gpbjMi3/q8gy8iLC2pUXw7Hy8F1Zqn/YJQF9Y+tbt37Oos/bVMO3o+j+tXA==",
      "use_cdn": true
    },
    "layer_js": {
      "suffix": "layer/3.5.1/layer.min.js",
      "sri": "sha512-0iG/yadTz/ltYp8fbzzZeJqp7ub0a0O8o3BFUKlCqUg7G72OSM2ASLiaheRfek5Plo6vJ4Wv7OBjYnPbOuwO1w==",
      "use_cdn": true
    },
    "popper": {
      "suffix": "popper.js/2.11.2/umd/popper.min.js",
      "sri": "sha512-aDciVjp+txtxTJWsp8aRwttA0vR2sJMk/73ZT7ExuEHv7I5E6iyyobpFOlEFkq59mWW8ToYGuVZFnwhwIUisKA==",
      "use_cdn": true
    },
    "bootstrap_css": {
      "suffix": "bootstrap/5.3.3/css/bootstrap.min.css",
      "sri": "sha512-jnSuA4Ss2PkkikSOLtYs8BlYIeeIK1h99ty4YfvRPAlzr377vr3CXDb7sb7eEEBYjDtcYj+AjBH3FLv5uSJuXg==",
      "use_cdn": true
    },
    "bootstrap_js": {
      "suffix": "bootstrap/5.3.3/js/bootstrap.min.js",
      "sri": "sha512-ykZ1QQr0Jy/4ZkvKuqWn4iF3lqPZyij9iRv6sGqLRdTPkY69YX6+7wvVGmsdBbiIfN/8OdsI7HABjvEok6ZopQ==",
      "use_cdn": true
    },
    "color_modes": {
      "suffix": "/static/js/color-modes.js",
      "sri": "sha512-bIqp9oBJpfQZj3ge/CHw+9wS+BzEeXKIUzMmmqvis3/g3EiZ7+C6hFYxUf3ndEJygVyOeE5cOPq15su++vuV8Q==",
      "use_cdn": false
    },
  }
};

async function loadResource(cdnPrefixes, suffix, sri, useCdn) {
    // 本地资源直接加载
    if (!useCdn) {
        let el;
        if (suffix.endsWith('.css')) {
            el = document.createElement('link');
            el.rel = 'stylesheet';
            el.href = suffix;
        } else {
            el = document.createElement('script');
            el.src = suffix;
            el.async = false;
        }
        
        const loadPromise = new Promise(resolve => {
            el.onload = () => resolve(true);
            el.onerror = () => resolve(false);
        });
        
        document.head.appendChild(el);
        
        try {
            await loadPromise;
            console.log(`✅ 加载成功: ${suffix}`);
        } catch {
            console.warn(`❌ 加载失败 ${suffix}`);
        }
        return;
    }

    // CDN 多源加载
    for (let i = 0; i < cdnPrefixes.length; i++) {
        const url = cdnPrefixes[i] + suffix;
        let el;
        if (url.endsWith('.css')) {
            el = document.createElement('link');
            el.rel = 'stylesheet';
            el.href = url;
            el.integrity = sri;
            el.crossOrigin = 'anonymous';
        } else {
            el = document.createElement('script');
            el.src = url;
            el.async = false;
            el.integrity = sri;
            el.crossOrigin = 'anonymous';
        }

        const loadPromise = new Promise((resolve, reject) => {
            el.onload = () => resolve(true);
            el.onerror = () => reject(false);
        });

        document.head.appendChild(el);

        try {
            await loadPromise;
            console.log(`✅ 加载成功: ${url}`);
            break;
        } catch {
            console.warn(`❌ 加载失败，尝试下一个: ${url}`);
            el.remove();
        }
    }
}

(async () => {
    const cdnPrefixes = res.cdn_prefixes;

    for (const [name, info] of Object.entries(res.resources)) {
        await loadResource(cdnPrefixes, info.suffix, info.sri, info.use_cdn);
    }
})();
        </script>
    </head>
    <body>
        <div class="container">
            <br><br>
            Hello!
        </div>
    </body>
</html>
